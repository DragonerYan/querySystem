var e,t,i,s;import{o as a,c as o,w as r,D as n,q as l,G as d,p as h,i as u,ab as c,ac as v,e as m,a as g,U as p,r as y,g as f,b as w,B as b,n as $,h as S,a5 as _,a3 as k,k as E}from"./index-ea6544a4.js";import{s as L,m as x,a as C,_ as B}from"./uv-icon.7381eece.js";import{_ as I,r as z}from"./uni-app.es.39bc03e5.js";import{_ as U,a as N}from"./uv-cell-group.d750e60e.js";import{_ as H}from"./uni-card.a47d36c5.js";import{t as T,_ as j}from"./toast.0c1427b2.js";const F={props:{show:{type:Boolean,default:!1},mode:{type:[String,null],default:"fade"},duration:{type:[String,Number],default:300},timingFunction:{type:String,default:"ease-out"},...null==(t=null==(e=uni.$uv)?void 0:e.props)?void 0:t.transition}},R=e=>({enter:`uv-${e}-enter uv-${e}-enter-active`,"enter-to":`uv-${e}-enter-to uv-${e}-enter-active`,leave:`uv-${e}-leave uv-${e}-leave-active`,"leave-to":`uv-${e}-leave-to uv-${e}-leave-active`});const O=I({name:"uv-transition",data:()=>({inited:!1,viewStyle:{},status:"",transitionEnded:!1,display:!1,classes:""}),computed:{mergeStyle(){const{viewStyle:e,customStyle:t}=this;return{transitionDuration:`${this.duration}ms`,transitionTimingFunction:this.timingFunction,...this.$uv.addStyle(t),...e}}},mixins:[x,C,{emits:["click","beforeEnter","enter","afterEnter","beforeLeave","leave","afterLeave"],methods:{clickHandler(){this.$emit("click")},async vueEnter(){const e=R(this.mode);this.status="enter",this.$emit("beforeEnter"),this.inited=!0,this.display=!0,this.classes=e.enter,await L(20),this.$emit("enter"),this.transitionEnded=!1,this.$emit("afterEnter"),this.classes=e["enter-to"]},async vueLeave(){if(!this.display)return;const e=R(this.mode);this.status="leave",this.$emit("beforeLeave"),this.classes=e.leave,await L(10),this.transitionEnded=!1,this.$emit("leave"),setTimeout(this.onTransitionEnd,this.duration),this.classes=e["leave-to"]},onTransitionEnd(){this.transitionEnded||(this.transitionEnded=!0,this.$emit("leave"===this.status?"afterLeave":"afterEnter"),!this.show&&this.display&&(this.display=!1,this.inited=!1))}}},F],watch:{show:{handler(e){e?this.vueEnter():this.vueLeave()},immediate:!0}}},[["render",function(e,t,i,s,c,v){const m=u;return c.inited?(a(),o(m,{key:0,class:l(["uv-transition",c.classes]),ref:"uv-transition",onClick:e.clickHandler,style:d([v.mergeStyle]),onTouchmove:e.noop},{default:r((()=>[n(e.$slots,"default",{},void 0,!0)])),_:3},8,["onClick","class","style","onTouchmove"])):h("",!0)}],["__scopeId","data-v-15c99949"]]);const M=I({name:"uv-image",emits:["click","load","error"],mixins:[x,C,{props:{src:{type:String,default:""},mode:{type:String,default:"aspectFill"},width:{type:[String,Number],default:"300"},height:{type:[String,Number],default:"225"},shape:{type:String,default:"square"},radius:{type:[String,Number],default:0},lazyLoad:{type:Boolean,default:!0},observeLazyLoad:{type:Boolean,default:!1},showMenuByLongpress:{type:Boolean,default:!0},loadingIcon:{type:String,default:"photo"},errorIcon:{type:String,default:"error-circle"},showLoading:{type:Boolean,default:!0},showError:{type:Boolean,default:!0},fade:{type:Boolean,default:!0},webp:{type:Boolean,default:!1},duration:{type:[String,Number],default:500},bgColor:{type:String,default:"#f3f4f6"},...null==(s=null==(i=uni.$uv)?void 0:i.props)?void 0:s.image}}],data(){return{isError:!1,loading:!0,backgroundStyle:{},show:!1,observeShow:!this.observeLazyLoad,elIndex:"",imgWidth:this.width,imgHeight:this.height,thresholdValue:50}},watch:{src:{immediate:!0,handler(e){e?(this.isError=!1,this.loading=!0):this.isError=!0}}},computed:{wrapStyle(){let e={};return e.width=this.$uv.addUnit(this.imgWidth),e.height=this.$uv.addUnit(this.imgHeight),e.borderRadius="circle"==this.shape?"10000px":this.$uv.addUnit(this.radius),e.overflow=this.radius>0?"hidden":"visible",this.$uv.deepMerge(e,this.$uv.addStyle(this.customStyle))},imageStyle(){let e={};return e.borderRadius="circle"==this.shape?"10000px":this.$uv.addUnit(this.radius),e}},created(){this.elIndex=this.$uv.guid(),this.observer={},this.observerName="lazyLoadContentObserver"},mounted(){this.show=!0,this.observeLazyLoad&&this.observerFn()},methods:{onClick(){this.$emit("click")},onErrorHandler(e){this.loading=!1,this.isError=!0,this.$emit("error",e)},onLoadHandler(e){"widthFix"==this.mode&&(this.imgHeight="auto"),"heightFix"==this.mode&&(this.imgWidth="auto"),this.loading=!1,this.isError=!1,this.$emit("load",e),this.removeBgColor()},removeBgColor(){this.backgroundStyle={backgroundColor:"transparent"}},observerFn(){this.$nextTick((()=>{c("onLazyLoadReachBottom",(()=>{this.observeShow||(this.observeShow=!0)}))})),setTimeout((()=>{this.disconnectObserver(this.observerName);const e=v(this);e.relativeToViewport({bottom:this.thresholdValue}).observe(`.uv-image--${this.elIndex}`,(e=>{e.intersectionRatio>0&&(this.observeShow=!0,this.disconnectObserver(this.observerName))})),this[this.observerName]=e}),50)},disconnectObserver(e){const t=this[e];t&&t.disconnect()}}},[["render",function(e,t,i,s,c,v){const y=p,f=z(m("uv-icon"),B),w=u,b=z(m("uv-transition"),O);return a(),o(b,{mode:"fade",show:c.show,duration:e.fade?1e3:0},{default:r((()=>[g(w,{class:l(["uv-image",[`uv-image--${c.elIndex}`]]),onClick:v.onClick,style:d([v.wrapStyle,c.backgroundStyle])},{default:r((()=>[!c.isError&&c.observeShow?(a(),o(y,{key:0,src:e.src,mode:e.mode,onError:v.onErrorHandler,onLoad:v.onLoadHandler,"show-menuv-by-longpress":e.showMenuByLongpress,"lazy-load":e.lazyLoad,class:"uv-image__image",style:d([v.imageStyle])},null,8,["src","mode","onError","onLoad","show-menuv-by-longpress","lazy-load","style"])):h("",!0),e.showLoading&&c.loading?(a(),o(w,{key:1,class:"uv-image__loading",style:d({borderRadius:"circle"==e.shape?"50%":e.$uv.addUnit(e.radius),backgroundColor:e.bgColor,width:e.$uv.addUnit(e.width),height:e.$uv.addUnit(e.height)})},{default:r((()=>[n(e.$slots,"loading",{},(()=>[g(f,{name:e.loadingIcon,width:e.width,height:e.height},null,8,["name","width","height"])]),!0)])),_:3},8,["style"])):h("",!0),e.showError&&c.isError&&!c.loading?(a(),o(w,{key:2,class:"uv-image__error",style:d({borderRadius:"circle"==e.shape?"50%":e.$uv.addUnit(e.radius),width:e.$uv.addUnit(e.width),height:e.$uv.addUnit(e.height)})},{default:r((()=>[n(e.$slots,"error",{},(()=>[g(f,{name:e.errorIcon,width:e.width,height:e.height},null,8,["name","width","height"])]),!0)])),_:3},8,["style"])):h("",!0)])),_:3},8,["class","onClick","style"])])),_:3},8,["show","duration"])}],["__scopeId","data-v-2aeb82f9"]]),V=I({__name:"index",setup(e){const t=y("https://cdn.uviewui.com/uview/album/1.jpg"),i=y(f("userInfo")||null),s=()=>{if(!i)return T("请登录");$({url:"/pages/my/set"})},n=()=>{if(!i)return T("请登录");$({url:"/pages/my/person"})},l=()=>{S({title:"确认退出",content:"确定需要退出吗？",success:async e=>{e.confirm?e&&(_({url:"/pages/login/index"}),T("退出成功"),k()):e.cancel&&console.log("用户点击了取消")}})};return(e,d)=>{const h=z(m("uv-image"),M),c=E,v=u,p=z(m("uv-icon"),B),y=z(m("uv-cell"),U),f=z(m("uv-cell-group"),N),$=z(m("uni-card"),H),S=z(m("uv-button"),j);return a(),o(v,{class:"my"},{default:r((()=>[g(v,{class:"head"},{default:r((()=>[g(h,{showLoading:!0,radius:"50%",src:t.value,width:"120rpx",height:"120rpx"},null,8,["src"]),g(v,{class:"info"},{default:r((()=>[g(c,{class:"title"},{default:r((()=>[w(b(i.value?i.value.userName:"未登录"),1)])),_:1})])),_:1}),g(p,{onClick:n,name:"arrow-right",color:"#fff",size:"20"})])),_:1}),g($,null,{default:r((()=>[g(f,null,{default:r((()=>[g(y,{size:"large",icon:"setting",onClick:s,title:"修改密码",isLink:""})])),_:1})])),_:1}),g(v,{class:"btns"},{default:r((()=>[g(S,{type:"primary",onClick:l},{default:r((()=>[w(" 退出登录 ")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-79c78ea6"]]);export{V as default};
