import{V as p,_ as w,u as b,I as O,a as P,B as x,b as $,R as S,c as j,g as C,n as f,S as z,T as D}from"./index-ea3d5ff2.js";import{L as k}from"./lock-on-bd37cb08.js";var I=["size"];function m(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,n)}return t}function d(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?m(Object(t),!0).forEach(function(n){P(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var L={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.5 4.25L8.47.77a.94.94 0 00-.94 0L1.5 4.25v6.96c0 .33.18.64.47.81L8 15.5l6.03-3.48a.94.94 0 00.47-.81V4.25zM8 7.42L3 4.54l5-2.89 5 2.89-5 2.88zm.5.87l5-2.89v5.77l-5 2.89V8.29zm-1 0v5.77l-5-2.89V5.4l5 2.89z",fillRule:"evenodd",clipRule:"evenodd"}}]},N=p.extend({name:"ControlPlatformIcon",functional:!0,props:{size:{type:String},onClick:{type:Function}},render:function(r,t){var n=t.props,o=t.data,a=n.size,i=w(n,I),s=b(a),c=s.className,l=s.style,u=d(d({},i||{}),{},{id:"control-platform",icon:L,staticClass:c,style:l});return o.props=u,r(O,o)}}),R=["size"];function _(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),t.push.apply(t,n)}return t}function v(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?_(Object(t),!0).forEach(function(n){P(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var V={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.5 5a3.5 3.5 0 11-7 0 3.5 3.5 0 017 0zm-1 0a2.5 2.5 0 10-5 0 2.5 2.5 0 005 0zM13.96 10.85c.34.16.54.5.54.87V14a.5.5 0 01-.5.5H2a.5.5 0 01-.5-.5v-2.28c0-.37.2-.7.54-.87a13.79 13.79 0 0111.92 0zM8 10.5c-1.97 0-3.83.45-5.5 1.24v1.76h11v-1.76A12.78 12.78 0 008 10.5z",fillOpacity:.9}}]},E=p.extend({name:"UserIcon",functional:!0,props:{size:{type:String},onClick:{type:Function}},render:function(r,t){var n=t.props,o=t.data,a=n.size,i=w(n,R),s=b(a),c=s.className,l=s.style,u=v(v({},i||{}),{},{id:"user",icon:V,staticClass:c,style:l});return o.props=u,r(O,o)}}),M=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("t-form",{ref:"form",class:["item-container",`login-${e.type}`],attrs:{data:e.formData,rules:e.FORM_RULES,"label-width":"0"},on:{submit:e.onSubmit}},[t("t-form-item",{attrs:{name:"treeValue"}},[t("t-tree-select",{ref:"single-tree-select",attrs:{data:e.options,value:e.formData.treeValue,treeProps:{expandAll:!0,allowFoldNodeOnFilter:!0,checkStrictly:!0,line:!0},clearable:"",filterable:"",placeholder:"请选择地区",size:"large"},on:{change:e.handleChage},scopedSlots:e._u([{key:"prefix-icon",fn:function(){return[t("control-platform-icon")]},proxy:!0}])})],1),t("t-form-item",{attrs:{name:"userName"}},[t("t-input",{attrs:{size:"large",placeholder:"请输入账号"},scopedSlots:e._u([{key:"prefix-icon",fn:function(){return[t("user-icon")]},proxy:!0}]),model:{value:e.formData.userName,callback:function(n){e.$set(e.formData,"userName",n)},expression:"formData.userName"}})],1),t("t-form-item",{attrs:{name:"password"}},[t("t-input",{key:"password",attrs:{size:"large",type:e.showPsw?"text":"password",clearable:"",placeholder:"请输入登录密码"},scopedSlots:e._u([{key:"prefix-icon",fn:function(){return[t("lock-on-icon")]},proxy:!0},{key:"suffix-icon",fn:function(){return[e.showPsw?t("browse-icon",{key:"browse",on:{click:function(n){e.showPsw=!e.showPsw}}}):t("browse-off-icon",{key:"browse-off",on:{click:function(n){e.showPsw=!e.showPsw}}})]},proxy:!0}]),model:{value:e.formData.password,callback:function(n){e.$set(e.formData,"password",n)},expression:"formData.password"}})],1),t("div",{staticClass:"check-container remember-pwd"},[t("t-checkbox",[e._v("记住账号")])],1),e.type!=="qrcode"?t("t-form-item",{staticClass:"btn-container"},[t("t-button",{attrs:{block:"",size:"large",type:"submit"}},[e._v(" 登录 ")])],1):e._e()],1)},F=[];const B={userName:"",password:"",county:"",province:"",city:"",treeValue:""},q={userName:[{required:!0,message:"账号必填",type:"error"}],password:[{required:!0,message:"密码必填",type:"error"}],treeValue:[{required:!0,message:"省市区街道社区必选",type:"error"}]},A=p.extend({name:"Login",components:{UserIcon:E,LockOnIcon:k,BrowseOffIcon:x,BrowseIcon:$,RefreshIcon:S,ControlPlatformIcon:N},data(){return{options:[],FORM_RULES:q,type:"password",formData:{...B},showPsw:!1,children:[]}},created(){this.getCommiunityInfo()},methods:{async getCommiunityInfo(){const e=await j();this.options=C(e.data.data)},async onSubmit({validateResult:e}){try{if(e===!0){console.log(this.formData);const r={...this.formData};for(let t in r)r[t]=r[t]||"-";delete r.treeValue,await this.$store.dispatch("user/login",{params:r,children:this.children}),this.$message.success("登录成功"),this.$router.replace("/dashboard/base").catch(()=>"")}}catch(r){this.$message.error(r)}},handleChage(e,r){var n,o,a,i;this.children=r.data;const t=(n=r.node)==null?void 0:n.getPath();this.formData.province=((o=t[0])==null?void 0:o.value)||"",this.formData.city=((a=t[1])==null?void 0:a.value)||"",this.formData.county=((i=t[2])==null?void 0:i.value)||"",this.formData.treeValue=(t==null?void 0:t.map(s=>s.value).join("/"))||""}}}),h={};var T=f(A,M,F,!1,U,null,null,null);function U(e){for(let r in h)this[r]=h[r]}const H=function(){return T.exports}();var K=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("header",{staticClass:"login-header"},[t("div",{staticClass:"operations-container"},[t("t-button",{attrs:{theme:"default",shape:"square",variant:"text"},on:{click:e.toggleSettingPanel}},[t("setting-icon",{staticClass:"icon"})],1)],1)])},W=[];const G={components:{SettingIcon:z},methods:{toggleSettingPanel(){this.$store.commit("setting/toggleSettingPanel",!0)}}},g={};var J=f(G,K,W,!1,Q,"2da1cb03",null,null);function Q(e){for(let r in g)this[r]=g[r]}const X=function(){return J.exports}();var Y=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"login-wrapper"},[t("div",{staticClass:"login-container"},[e._m(0),e.type==="login"?t("login"):e._e(),t("tdesign-setting")],1)])},Z=[function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"title-container"},[t("h1",{staticClass:"title margin-no"},[e._v("登录到")]),t("h1",{staticClass:"title"},[e._v("城市体检数据调查系统")])])}];const ee={name:"LoginIndex",components:{LoginHeader:X,Login:H,TdesignSetting:D},data(){return{type:"login"}},methods:{switchType(e){this.type=e}}},y={};var te=f(ee,Y,Z,!1,re,null,null,null);function re(e){for(let r in y)this[r]=y[r]}const se=function(){return te.exports}();export{se as default};
