import{V as p,_ as w,u as b,I as O,a as P,B as x,b as $,R as S,c as j,g as C,d as z,n as f,S as D,T as k}from"./index-21681da6.js";import{L as I}from"./lock-on-fe2066e0.js";var L=["size"];function d(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function m(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?d(Object(t),!0).forEach(function(n){P(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var V={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M14.5 4.25L8.47.77a.94.94 0 00-.94 0L1.5 4.25v6.96c0 .33.18.64.47.81L8 15.5l6.03-3.48a.94.94 0 00.47-.81V4.25zM8 7.42L3 4.54l5-2.89 5 2.89-5 2.88zm.5.87l5-2.89v5.77l-5 2.89V8.29zm-1 0v5.77l-5-2.89V5.4l5 2.89z",fillRule:"evenodd",clipRule:"evenodd"}}]},N=p.extend({name:"ControlPlatformIcon",functional:!0,props:{size:{type:String},onClick:{type:Function}},render:function(r,t){var n=t.props,a=t.data,o=n.size,i=w(n,L),s=b(o),c=s.className,l=s.style,u=m(m({},i||{}),{},{id:"control-platform",icon:V,staticClass:c,style:l});return a.props=u,r(O,a)}}),R=["size"];function _(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function h(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?_(Object(t),!0).forEach(function(n){P(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var E={tag:"svg",attrs:{fill:"none",viewBox:"0 0 16 16",width:"1em",height:"1em"},children:[{tag:"path",attrs:{fill:"currentColor",d:"M11.5 5a3.5 3.5 0 11-7 0 3.5 3.5 0 017 0zm-1 0a2.5 2.5 0 10-5 0 2.5 2.5 0 005 0zM13.96 10.85c.34.16.54.5.54.87V14a.5.5 0 01-.5.5H2a.5.5 0 01-.5-.5v-2.28c0-.37.2-.7.54-.87a13.79 13.79 0 0111.92 0zM8 10.5c-1.97 0-3.83.45-5.5 1.24v1.76h11v-1.76A12.78 12.78 0 008 10.5z",fillOpacity:.9}}]},M=p.extend({name:"UserIcon",functional:!0,props:{size:{type:String},onClick:{type:Function}},render:function(r,t){var n=t.props,a=t.data,o=n.size,i=w(n,R),s=b(o),c=s.className,l=s.style,u=h(h({},i||{}),{},{id:"user",icon:E,staticClass:c,style:l});return a.props=u,r(O,a)}}),F=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("t-form",{ref:"form",class:["item-container",`login-${e.type}`],attrs:{data:e.formData,rules:e.FORM_RULES,"label-width":"0"},on:{submit:e.onSubmit}},[t("t-form-item",{attrs:{name:"treeValue"}},[t("t-tree-select",{ref:"single-tree-select",attrs:{data:e.options,loading:e.dataLoading,value:e.formData.treeValue,treeProps:{expandAll:!1,allowFoldNodeOnFilter:!0,checkStrictly:!0,line:!0,expandParent:!0},filterable:"",placeholder:"请选择地区",size:"large"},on:{change:e.handleChage},scopedSlots:e._u([{key:"prefix-icon",fn:function(){return[t("control-platform-icon")]},proxy:!0}])})],1),t("t-form-item",{attrs:{name:"userName"}},[t("t-input",{attrs:{size:"large",placeholder:"请输入账号"},scopedSlots:e._u([{key:"prefix-icon",fn:function(){return[t("user-icon")]},proxy:!0}]),model:{value:e.formData.userName,callback:function(n){e.$set(e.formData,"userName",n)},expression:"formData.userName"}})],1),t("t-form-item",{attrs:{name:"password"}},[t("t-input",{key:"password",attrs:{size:"large",type:e.showPsw?"text":"password",clearable:"",placeholder:"请输入登录密码"},scopedSlots:e._u([{key:"prefix-icon",fn:function(){return[t("lock-on-icon")]},proxy:!0},{key:"suffix-icon",fn:function(){return[e.showPsw?t("browse-icon",{key:"browse",on:{click:function(n){e.showPsw=!e.showPsw}}}):t("browse-off-icon",{key:"browse-off",on:{click:function(n){e.showPsw=!e.showPsw}}})]},proxy:!0}]),model:{value:e.formData.password,callback:function(n){e.$set(e.formData,"password",n)},expression:"formData.password"}})],1),t("div",{staticClass:"check-container remember-pwd"},[t("t-checkbox",[e._v("记住账号")])],1),e.type!=="qrcode"?t("t-form-item",{staticClass:"btn-container"},[t("t-button",{attrs:{block:"",size:"large",type:"submit"}},[e._v(" 登录 ")])],1):e._e()],1)},B=[];const q={userName:"",password:"",county:"",province:"",city:"",treeValue:""},A={userName:[{required:!0,message:"账号必填",type:"error"}],password:[{required:!0,message:"密码必填",type:"error"}],treeValue:[{required:!0,message:"省市区街道社区必选",type:"error"}]},T=p.extend({name:"Login",components:{UserIcon:M,LockOnIcon:I,BrowseOffIcon:x,BrowseIcon:$,RefreshIcon:S,ControlPlatformIcon:N},data(){return{options:[],FORM_RULES:A,type:"password",formData:{...q},showPsw:!1,dataLoading:!1,children:[]}},created(){this.getCommiunityInfo()},methods:{async getCommiunityInfo(){this.dataLoading=!0;const e=await j();this.options=C(e.data.data),this.dataLoading=!1},async onSubmit({validateResult:e}){try{if(e===!0){const r={...this.formData};for(let t in r)r[t]=z(r[t]);delete r.treeValue,await this.$store.dispatch("user/login",{params:r,children:this.children}),this.$message.success("登录成功"),this.$router.replace("/dashboard/base").catch(()=>"")}}catch(r){this.$message.error(r)}},handleChage(e,r){var n,a,o,i;this.children=r.data;const t=(n=r.node)==null?void 0:n.getPath();this.formData.province=((a=t[0])==null?void 0:a.value)||"",this.formData.city=((o=t[1])==null?void 0:o.value)||"",this.formData.county=((i=t[2])==null?void 0:i.value)||"",this.formData.treeValue=(t==null?void 0:t.map(s=>s.label).join("/"))||""}}}),v={};var U=f(T,F,B,!1,H,null,null,null);function H(e){for(let r in v)this[r]=v[r]}const K=function(){return U.exports}();var W=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("header",{staticClass:"login-header"},[t("div",{staticClass:"operations-container"},[t("t-button",{attrs:{theme:"default",shape:"square",variant:"text"},on:{click:e.toggleSettingPanel}},[t("setting-icon",{staticClass:"icon"})],1)],1)])},G=[];const J={components:{SettingIcon:D},methods:{toggleSettingPanel(){this.$store.commit("setting/toggleSettingPanel",!0)}}},g={};var Q=f(J,W,G,!1,X,"2da1cb03",null,null);function X(e){for(let r in g)this[r]=g[r]}const Y=function(){return Q.exports}();var Z=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"login-wrapper"},[t("div",{staticClass:"login-container"},[e._m(0),e.type==="login"?t("login"):e._e(),t("tdesign-setting")],1)])},ee=[function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"title-container"},[t("h1",{staticClass:"title margin-no"},[e._v("登录到")]),t("h1",{staticClass:"title"},[e._v("城市体检数据调查系统")])])}];const te={name:"LoginIndex",components:{LoginHeader:Y,Login:K,TdesignSetting:k},data(){return{type:"login"}},methods:{switchType(e){this.type=e}}},y={};var re=f(te,Z,ee,!1,ne,null,null,null);function ne(e){for(let r in y)this[r]=y[r]}const oe=function(){return re.exports}();export{oe as default};
